# -----------------------------------------------------------------------------
# description: General Project Makefile
# author: Daniel Kovacs <mondomhogynincsen@gmail.com>
# licence: GPL3 <https://opensource.org/licenses/GPL3>
# version: 2.1.1
# supported: vagrant
# -----------------------------------------------------------------------------


# -----------------------------------------------------------------------------
# package config
# -----------------------------------------------------------------------------


# -----------------------------------------------------------------------------
# .vagrant
# -----------------------------------------------------------------------------

.vagrant::
	vagrant up
	touch .vagrant


# -----------------------------------------------------------------------------
# vm-start
# -----------------------------------------------------------------------------

vm-start:: .vagrant

vm:: vm-start


# -----------------------------------------------------------------------------
# vm-stop
# -----------------------------------------------------------------------------

vm-stop::
	vagrant halt


# -----------------------------------------------------------------------------
# vm-provision
# -----------------------------------------------------------------------------

vm-provision::
	vagrant rsync
	vagrant provision


# -----------------------------------------------------------------------------
# vm-recreate
# -----------------------------------------------------------------------------

vm-recreate::
	vagrant destroy -f
	vagrant up


# -----------------------------------------------------------------------------
# vm-destroy
# -----------------------------------------------------------------------------

vm-destroy::
	vagrant destroy -f


# -----------------------------------------------------------------------------
# vm-portforwards
# -----------------------------------------------------------------------------

	# vagrant ssh -c "sudo su - dev" -- -A -L8000:127.0.0.1:8000 -L8080:127.0.0.1:8080 -L8081:127.0.0.1:8081 -L8089:127.0.0.1:8089 -L8888:127.0.0.1:8888 -L\*:4200:127.0.0.1:4200

vm-portforwards::
	vagrant ssh -- \
		-l dev \
		-A \
		-L8000:127.0.0.1:8000 \
		-L8080:127.0.0.1:8080 \
		-L8081:127.0.0.1:8081 \
		-L8089:127.0.0.1:8089 \
		-L8888:127.0.0.1:8888 \
		-L\*:4200:127.0.0.1:4200

portforwards:: vm-portforwards

pf:: vm-portforwards


# -----------------------------------------------------------------------------
# vm-ssh
# -----------------------------------------------------------------------------

	# vagrant ssh -c "sudo su - dev"

vm-ssh::
	vagrant ssh -- -l dev -A

ssh:: vm-ssh

	